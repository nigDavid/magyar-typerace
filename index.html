<script>
        const szotar = ["alma", "erdő", "asztal", "tanulás", "magyar", "ország", "számítógép", "internet", "munka", "iskola", "folyó", "város", "autó", "macska", "kutya", "szeretet", "felhő", "ablak", "ajtó", "könyv", "újság", "telefon", "tavasz", "nyár", "ősz", "tél", "reggel", "este", "holnap", "tegnap", "beszéd", "játék", "pénz", "piac", "vidám", "gyors", "lassú", "ember", "gyerek", "család", "világ", "élet", "híd", "kapu", "virág", "madár", "repülő", "vonat", "kávé", "ebéd", "vacsora", "szék", "lámpa", "kép", "fal", "tető", "utca", "tér", "szín", "kék", "zöld", "piros", "sárga", "fehér", "fekete", "szürke", "barna", "erős", "gyenge", "meleg", "hideg", "eső", "geci", "kuki", "móni", "xd", "cigány", "holló", "Rikárdó", "kislány", "csinálás", "sexy", "punci", "hülye", "szeretlek", "gazdag", "adócsaló", "NAV", "67", "niga", "lop", "Spar", "Aldi", ];

        let currentText = "";
        let startTime = null;
        let timerInterval = null;
        let isFinished = false;

        const textContainer = document.getElementById('text-container');
        const inputField = document.getElementById('input-field');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const timerDisplay = document.getElementById('timer');

        function updateDailyCounter() {
            const today = new Date().toDateString();
            let data = JSON.parse(localStorage.getItem('typingCounter')) || { date: today, count: 0 };
            if (data.date !== today) data = { date: today, count: 0 };
            document.getElementById('daily-session-count').innerText = data.count;
            return data;
        }

        function incrementDailyCounter() {
            let data = updateDailyCounter();
            data.count++;
            localStorage.setItem('typingCounter', JSON.stringify(data));
            document.getElementById('daily-session-count').innerText = data.count;
        }

        function generateRandomText() {
            let words = [];
            for(let i = 0; i < 15; i++) {
                words.push(szotar[Math.floor(Math.random() * szotar.length)]);
            }
            currentText = words.join(" ");
            textContainer.innerHTML = "";
            currentText.split("").forEach(char => {
                const span = document.createElement('span');
                span.innerText = char;
                span.classList.add('char');
                textContainer.appendChild(span);
            });
        }

        function focusInput() { inputField.focus(); }

        function resetGame() {
            clearInterval(timerInterval);
            startTime = null;
            isFinished = false;
            inputField.value = "";
            wpmDisplay.innerText = "0";
            accuracyDisplay.innerText = "100";
            timerDisplay.innerText = "0";
            generateRandomText();
            updateCharStyles();
            focusInput();
        }

        inputField.addEventListener('input', () => {
            if (!startTime && inputField.value.length > 0) {
                startTime = new Date();
                timerInterval = setInterval(updateStats, 100);
            }
            updateCharStyles();
            if (inputField.value.length >= currentText.length && !isFinished) {
                isFinished = true;
                clearInterval(timerInterval);
                incrementDailyCounter();
            }
        });

        function updateCharStyles() {
            const spans = textContainer.querySelectorAll('.char');
            const val = inputField.value.split("");
            let mistakes = 0;

            spans.forEach((span, i) => {
                span.className = "char";
                if (i < val.length) {
                    if (val[i] === currentText[i]) {
                        span.classList.add('char-correct');
                    } else {
                        span.classList.add('char-wrong');
                        mistakes++;
                    }
                } else if (i === val.length) {
                    span.classList.add('char-current');
                }
            });

            if (val.length > 0) {
                let acc = Math.floor(((val.length - mistakes) / val.length) * 100);
                accuracyDisplay.innerText = acc < 0 ? 0 : acc;
            }
        }

        function updateStats() {
            const timeElapsed = (new Date() - startTime) / 1000;
            timerDisplay.innerText = timeElapsed.toFixed(1);
            const wordsTyped = inputField.value.length / 5;
            const wpm = Math.round(wordsTyped / (timeElapsed / 60));
            wpmDisplay.innerText = wpm > 0 ? wpm : 0;
        }

        function acceptCookies() { document.getElementById('cookie-banner').style.display = 'none'; }
        
        window.addEventListener('keydown', (e) => { if(e.key === "Escape") resetGame(); });

        updateDailyCounter();
        resetGame();
    </script>
</body>
</html>